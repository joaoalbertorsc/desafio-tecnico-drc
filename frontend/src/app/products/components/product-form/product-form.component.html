<div class="container">
  <h2>{{ isEditMode ? 'Editar Produto' : 'Novo Produto' }}</h2>

  <form [formGroup]="productForm" (ngSubmit)="onSubmit()">

    <div class="form-group">
      <label for="name">Nome *</label>
      <input
        id="name"
        type="text"
        formControlName="name"
        class="form-control"
        placeholder="Ex: Caneca Plástica, Lápis Colorido..."
      >
      <div *ngIf="productForm.get('name')?.invalid && productForm.get('name')?.touched" class="error">
        <div *ngIf="productForm.get('name')?.hasError('required')">
          Nome é obrigatório.
        </div>
        <div *ngIf="productForm.get('name')?.hasError('pattern')">
          O nome deve conter pelo menos uma letra.
        </div>
      </div>
    </div>

    <div class="form-group">
      <label for="category">Categoria *</label>
      <input
        id="category"
        type="text"
        formControlName="category"
        class="form-control"
        placeholder="Ex: Papelaria, Cozinha..."
      >
      <div *ngIf="productForm.get('category')?.invalid && productForm.get('category')?.touched" class="error">
        <div *ngIf="productForm.get('category')?.hasError('required')">
          Categoria é obrigatória.
        </div>
        <div *ngIf="productForm.get('category')?.hasError('pattern')">
          A categoria deve conter pelo menos uma letra.
        </div>
      </div>
    </div>

    <div class="form-group">
      <label for="description">Descrição</label>
      <textarea
        id="description"
        formControlName="description"
        class="form-control"
        maxlength="255"
        placeholder="Ex: Descrição simples do produto..."
      ></textarea>
      <div class="char-counter">
        {{ productForm.get('description')?.value?.length || 0 }} / 255
      </div>
      <div *ngIf="productForm.get('description')?.invalid && productForm.get('description')?.touched" class="error">
        <div *ngIf="productForm.get('description')?.hasError('maxlength')">
          A descrição não pode exceder 255 caracteres.
        </div>
        <div *ngIf="productForm.get('description')?.hasError('pattern')">
          A descrição deve conter pelo menos uma letra.
        </div>
      </div>
    </div>

    <div class="form-group">
      <label for="price">Preço *</label>
      <input
        id="price"
        type="number"
        formControlName="price"
        class="form-control"
        placeholder="Ex: 500,00"
      >
      <div *ngIf="productForm.get('price')?.invalid && productForm.get('price')?.touched" class="error">
        Preço deve ser maior que zero.
      </div>
    </div>

    <div class="form-group">
      <label for="stockQuantity">Quantidade em Estoque *</label>
      <input
        id="stockQuantity"
        type="number"
        formControlName="stockQuantity"
        class="form-control"
        placeholder="Ex: 20"
      >
      <div *ngIf="productForm.get('stockQuantity')?.invalid && productForm.get('stockQuantity')?.touched" class="error">
        Quantidade deve ser maior ou igual a zero.
      </div>
    </div>

    <div class="form-group">
      <label for="barcode">Código de Barras</label>
      <input
        id="barcode"
        type="text"
        formControlName="barcode"
        class="form-control"
        placeholder="Ex: 1234567890"
      >
      <div *ngIf="productForm.get('barcode')?.invalid && productForm.get('barcode')?.touched" class="error">
        <div *ngIf="productForm.get('barcode')?.hasError('pattern')">
          O código de barras deve conter apenas números.
        </div>
      </div>
    </div>

    <div class="form-group checkbox-group">
      <label for="active">
        <input id="active" type="checkbox" formControlName="active">
        Ativo
      </label>
    </div>

    <div class="form-group checkbox-group">
      <label for="onSale">
        <input id="onSale" type="checkbox" formControlName="onSale">
        Em Promoção
      </label>
    </div>

    <div class="actions">
      <button type="submit" [disabled]="productForm.invalid" class="btn-primary">
        Salvar
      </button>
      <button type="button" routerLink="/products" class="btn-secondary">
        Cancelar
      </button>
    </div>

  </form>
</div>
